#!/usr/bin/env python3
'''
Date : 1401/12/21
Author : AmirhosseinKhanshabani - @AmirZoyber
Description: an script for cracking SHA256 hash with a password list.           
'''
#from pwn import *
import sys
from colorama import Fore, Back, Style,init
import hashlib
from logging import log

init(autoreset=True)

if (len(sys.argv) != 2):
    print(Fore.RED+"[!] Invalid arguments.")
    #print(" >> Usage:  python3 SHA256Cracker.py [hash] [passwordlist]")
    print("  >> Usage:  python3 {} <SHA256sum>".format(sys.argv[0]))
    exit(1)

wantedHash = sys.argv[1]
passwordFile = "passwords.txt"
attemps = 0

with log.process(f"Start cracking {wantedHash}") as p:
    with open(passwordFile,'r',encoding='latin-1') as passList:           # encoding can be utf-8 or latin-1
        for password in passList.readlines():
            password = password.strip().encode('latin-1')                   # encod() can be utf-8 or latin-1
            try:
                print(Fore.YELLOW+"[/] Trying: " + password)
                hash = hashlib.sha256(password.encode()).hexdigest()
                p.status(Fore.LIGHTYELLOW_EX+f"[\] Trying {attemps} {password} : {hash}")
                if (hash == wantedHash):
                    print(Fore.GREEN+"[+] Password found: " + password)
                    p.success(Fore.GREEN+f"[+] Password found after {attemps} attemps!\n\t\t{password} : {hash}")
                    break
                else:
                    print(Fore.LIGHTRED_EX+"[-] Password incorrect: " + password)
                    p.failure(Fore.LIGHTRED_EX+f"[-] Password incorrect {password} : {hash}")
                    attemps += 1
                    continue
            except:
                print(Fore.RED+"[!] Connection error")
                break