#!/usr/bin/env python3
'''
Date : 1401/12/21
Author : AmirhosseinKhanshabani - @AmirZoyber
Description: an script for cracking SHA256 hash with a password list.           
'''
#from pwn import *
import sys
from colorama import Fore, Back, Style,init
import hashlib

init(autoreset=True)

wantedHash = input("Enter the SHA256 hash: ")

passwordFile = "passwords.txt"
attemps = 0

with open(passwordFile,'r',encoding='latin-1') as passList:           # encoding can be utf-8 or latin-1
        for password in passList.readlines():
            password = password.strip().encode('latin-1')                   # encod() can be utf-8 or latin-1
            try:
                print(Fore.YELLOW+"[/] Trying: " + password)
                hash = hashlib.sha256(password.encode()).hexdigest()
                if (hash == wantedHash):
                    print(Fore.GREEN+"[+] Password found: " + password)
                    break
                else:
                    print(Fore.LIGHTRED_EX+"[-] Password incorrect: " + password)
                    attemps += 1
                    continue
            except:
                print(Fore.RED+"[!] Connection error")
                break