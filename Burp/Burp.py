#!/usr/bin/env python3
'''
Date : 1402/01/30
Author : AmirhosseinKhanshabani - @AmirZoyber
 
Burp - Burp Suite in Python
this script is used to intercept the requests and responses of the browser and modify them


'''

from burp import IBurpExtender, ITab
from javax import swing
from java.awt import BorderLayout
import sys, time, socket, threading
from exceptions_fix import FixBurpExceptions

class BurpExtender(IBurpExtender, ITab):
    def registerExtenderCallbacks(self, callbacks):
        self.clicked = False
        self.responseData = None
        self.killThreads = False
        sys.stdout = callbacks.getStdout()
        self.callbacks = callbacks
        self.callbacks.setExtensionName("Burp")
        self.tab = swing.JPanel(BorderLayout())
        
        textPanel = swing.JPanel() 
        boxVertical = swing.Box.createVerticalBox()
        boxHorizontal = swing.Box.createHorizontalBox()
        
        self.ipAddress = swing.JTextField(20)
        self.ipAddress.setLineWrap(True)
        self.ipAddress.border = swing.BorderFactory.createTitledBorder("IP Address")
        boxHorizontal.add(self.ipAddress)
        boxVertical.add(boxHorizontal)

        boxHorizontal = swing.Box.createHorizontalBox()
        self.userCommand = swing.JTextField(20)
        self.userCommand.setLineWrap(True)
        self.userCommand.border = swing.BorderFactory.createTitledBorder("Command")
        boxHorizontal.add(self.userCommand)
        boxVertical.add(boxHorizontal)

        textPanel.add(boxVertical)
        self.tab.add(textPanel, BorderLayout.NORTH)


        callbacks.addSuiteTab(self)
        return
    
    def getTabCaption(self):
        return "Burp"
    
    def getUiComponent(self):
        return self.tab
FixBurpExceptions()

        